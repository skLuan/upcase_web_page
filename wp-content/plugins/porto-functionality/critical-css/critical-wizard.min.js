"use strict";window.themeAdmin=window.themeAdmin||{},function(i){var a={$form:i("#porto-critical-form"),$tableForm:i("#porto-critical-table-form"),$progressBar:i(".porto-progress-bar"),criticalDone:0,criticalTodo:0,init:function(){var a=i("#porto-select-particular");a.select2({placeholder:a.attr("data-placeholder")}),i("#porto-critical-page").on("change",(function(){"individual_pages"==i(this).val()?i("label[for=porto-select-particular]").removeClass("disabled"):i("label[for=porto-select-particular]").addClass("disabled")})),0==i(".temp-iframe").length&&i("body").append('<iframe class="temp-iframe" style="max-width: none; max-height: none; border: 0px;" aria-hidden="true" sandbox="allow-same-origin "></iframe>'),this.$form.on("submit",(function(a){a.preventDefault(),themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed"),i(this).find("button").addClass("disabled").html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Generating Critical","porto-functionality")),i.post(ajaxurl,themeAdmin.criticalWizard.$form.serialize(),(async function(a){if("object"==typeof a.data){var t=a.data,e=Object.keys(t).length;if(0==e)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=e;for(var r=Object.keys(t),c=0;c<r.length;c++){var o=r[c],s={};await themeAdmin.criticalCss.main(t[o].desktop),s.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(t[o].mobile,"mobile",!0),s.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await i.post(ajaxurl,{action:"porto_save_critical",id:o,pageCriticalCss:s,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){console.log(i)}))}await i.post(ajaxurl,{action:"porto_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))})),this.$tableForm.on("click",".porto-recompile-row",(function(a){a.preventDefault();var t=i(this);if(t.hasClass("disabled"))return!1;themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed"),themeAdmin.criticalWizard.$tableForm.find(".button").addClass("disabled"),t.html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Recompile","porto-functionality")),i.post(ajaxurl,{action:"porto_critical_get_page",porto_critical_page:"individual_pages",porto_select_particular:t.closest("tr").attr("data-page-id"),porto_critical_nonce:themeAdmin.criticalWizard.$tableForm.attr("data-nonce")},(async function(a){if("object"==typeof a.data){var t=a.data,e=Object.keys(t).length;if(0==e)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=e;var r={},c=Object.keys(t)[0];await themeAdmin.criticalCss.main(t[c].desktop),r.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(t[c].mobile,"mobile",!0),r.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await i.post(ajaxurl,{action:"porto_save_critical",id:c,pageCriticalCss:r,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){console.log(i)})),await i.post(ajaxurl,{action:"porto_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))})),this.$tableForm.on("submit",(function(a){var t=i(this);if("porto_bulk_delete_critical"!=t.find("#bulk-action-selector-top").val()&&(a.preventDefault(),"-1"!=t.find("#bulk-action-selector-top").val())){themeAdmin.criticalWizard.$tableForm.find(".button").addClass("disabled"),t.find(".button.action").html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Apply","porto-functionality")),themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed");var e=[];t.find("tbody tr").each((function(){i(this).find('input[type="checkbox"]').is(":checked")&&e.push(i(this).attr("data-page-id"))})),i.post(ajaxurl,{action:"porto_critical_get_page",porto_critical_page:"individual_pages","porto_select_particular[]":e,porto_critical_nonce:t.attr("data-nonce")},(async function(a){if("object"==typeof a.data){var t=a.data,e=Object.keys(t).length;if(0==e)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=e;for(var r=Object.keys(t),c=0;c<r.length;c++){var o=r[c],s={};await themeAdmin.criticalCss.main(t[o].desktop),s.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(t[o].mobile,"mobile",!0),s.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await i.post(ajaxurl,{action:"porto_save_critical",id:o,pageCriticalCss:s,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){console.log(i)}))}await i.post(ajaxurl,{action:"porto_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(i){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))}}))}};themeAdmin.criticalWizard=a,i(document).ready((function(){a.init()}))}(window.jQuery);
<<<<<<< HEAD
!function(we){var Se=Math.abs,ze=Math.max,ke=Math.min,Ce=Math.round;function Ae(){return we("<div/>")}we.imgAreaSelect=function(o,n){var t,i,r,c,d,a,s,u,l,h,f,m,e,p,y,g,v,b,x,w,S,z,k,C,A,W,I,K,P=we(o),N=Ae(),H=Ae(),M=Ae().add(Ae()).add(Ae()).add(Ae()),E=Ae().add(Ae()).add(Ae()).add(Ae()),O=we([]),T={left:0,top:0},L={left:0,top:0},j=0,D="absolute",R={x1:0,y1:0,x2:0,y2:0,width:0,height:0},X=document.documentElement,Y=navigator.userAgent;function $(e){return e+T.left-L.left}function q(e){return e+T.top-L.top}function B(e){return e-T.left+L.left}function Q(e){return e-T.top+L.top}function F(e){return ze(e.pageX||0,J(e).x)-L.left}function G(e){return ze(e.pageY||0,J(e).y)-L.top}function J(e){e=e.originalEvent||{};return e.touches&&e.touches.length?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:0,y:0}}function U(e){var t=e||h,e=e||f;return{x1:Ce(R.x1*t),y1:Ce(R.y1*e),x2:Ce(R.x2*t),y2:Ce(R.y2*e),width:Ce(R.x2*t)-Ce(R.x1*t),height:Ce(R.y2*e)-Ce(R.y1*e)}}function V(e,t,o,i,s){var n=s||h,s=s||f;(R={x1:Ce(e/n||0),y1:Ce(t/s||0),x2:Ce(o/n||0),y2:Ce(i/s||0)}).width=R.x2-R.x1,R.height=R.y2-R.y1}function Z(){t&&P.width()&&(T={left:Ce(P.offset().left),top:Ce(P.offset().top)},d=P.innerWidth(),a=P.innerHeight(),T.top+=P.outerHeight()-a>>1,T.left+=P.outerWidth()-d>>1,e=Ce(n.minWidth/h)||0,p=Ce(n.minHeight/f)||0,y=Ce(ke(n.maxWidth/h||1<<24,d)),g=Ce(ke(n.maxHeight/f||1<<24,a)),"1.3.2"!=we().jquery||"fixed"!=D||X.getBoundingClientRect||(T.top+=ze(document.body.scrollTop,X.scrollTop),T.left+=ze(document.body.scrollLeft,X.scrollLeft)),L=/absolute|relative/.test(s.css("position"))?{left:Ce(s.offset().left)-s.scrollLeft(),top:Ce(s.offset().top)-s.scrollTop()}:"fixed"==D?{left:we(document).scrollLeft(),top:we(document).scrollTop()}:{left:0,top:0},r=$(0),c=q(0),(R.x2>d||R.y2>a)&&re())}function _(e){if(b){switch(N.css({left:$(R.x1),top:q(R.y1)}).add(H).width(W=R.width).height(I=R.height),H.add(M).add(O).css({left:0,top:0}),M.width(ze(W-M.outerWidth()+M.innerWidth(),0)).height(ze(I-M.outerHeight()+M.innerHeight(),0)),we(E[0]).css({left:r,top:c,width:R.x1,height:a}),we(E[1]).css({left:r+R.x1,top:c,width:W,height:R.y1}),we(E[2]).css({left:r+R.x2,top:c,width:d-R.x2,height:a}),we(E[3]).css({left:r+R.x1,top:c+R.y2,width:W,height:a-R.y2}),W-=O.outerWidth(),I-=O.outerHeight(),O.length){case 8:we(O[4]).css({left:W>>1}),we(O[5]).css({left:W,top:I>>1}),we(O[6]).css({left:W>>1,top:I}),we(O[7]).css({top:I>>1});case 4:O.slice(1,3).css({left:W}),O.slice(2,4).css({top:I})}!1!==e&&(we.imgAreaSelect.onKeyPress!=pe&&we(document).off(we.imgAreaSelect.keyPress,we.imgAreaSelect.onKeyPress),n.keys&&we(document).on(we.imgAreaSelect.keyPress,function(){we.imgAreaSelect.onKeyPress=pe})),ve&&M.outerWidth()-M.innerWidth()==2&&(M.css("margin",0),setTimeout(function(){M.css("margin","auto")},0))}}function ee(e){Z(),_(e),x=$(R.x1),w=q(R.y1),S=$(R.x2),z=q(R.y2)}function te(e,t){n.fadeSpeed?e.fadeOut(n.fadeSpeed,t):e.hide()}function oe(e){var t=B(F(e))-R.x1,e=Q(G(e))-R.y1;K||(Z(),K=!0,N.one("mouseout",function(){K=!1})),m="",n.resizable&&(e<=n.resizeMargin?m="n":e>=R.height-n.resizeMargin&&(m="s"),t<=n.resizeMargin?m+="w":t>=R.width-n.resizeMargin&&(m+="e")),N.css("cursor",m?m+"-resize":n.movable?"move":""),i&&i.toggle()}function ie(e){we("body").css("cursor",""),!n.autoHide&&R.width*R.height!=0||te(N.add(E),function(){we(this).hide()}),we(document).off("mousemove touchmove",ce),N.on("mousemove touchmove",oe),n.onSelectEnd(o,U())}function se(e){return"mousedown"==e.type&&1!=e.which||(oe(e),Z(),m?(we("body").css("cursor",m+"-resize"),x=$(R[/w/.test(m)?"x2":"x1"]),w=q(R[/n/.test(m)?"y2":"y1"]),we(document).on("mousemove touchmove",ce).one("mouseup touchend",ie),N.off("mousemove touchmove",oe)):n.movable?(u=r+R.x1-F(e),l=c+R.y1-G(e),N.off("mousemove touchmove",oe),we(document).on("mousemove touchmove",ae).one("mouseup touchend",function(){n.onSelectEnd(o,U()),we(document).off("mousemove touchmove",ae),N.on("mousemove touchmove",oe)})):P.mousedown(e)),!1}function ne(e){v&&(e?(S=ze(r,ke(r+d,x+Se(z-w)*v*(x<S||-1))),z=Ce(ze(c,ke(c+a,w+Se(S-x)/v*(w<z||-1)))),S=Ce(S)):(z=ze(c,ke(c+a,w+Se(S-x)/v*(w<z||-1))),S=Ce(ze(r,ke(r+d,x+Se(z-w)*v*(x<S||-1)))),z=Ce(z)))}function re(){x=ke(x,r+d),w=ke(w,c+a),Se(S-x)<e&&((S=x-e*(S<x||-1))<r?x=r+e:r+d<S&&(x=r+d-e)),Se(z-w)<p&&((z=w-p*(z<w||-1))<c?w=c+p:c+a<z&&(w=c+a-p)),S=ze(r,ke(S,r+d)),z=ze(c,ke(z,c+a)),ne(Se(S-x)<Se(z-w)*v),Se(S-x)>y&&(S=x-y*(S<x||-1),ne()),Se(z-w)>g&&(z=w-g*(z<w||-1),ne(!0)),R={x1:B(ke(x,S)),x2:B(ze(x,S)),y1:Q(ke(w,z)),y2:Q(ze(w,z)),width:Se(S-x),height:Se(z-w)},_(),n.onSelectChange(o,U())}function ce(e){return S=/w|e|^$/.test(m)||v?F(e):$(R.x2),z=/n|s|^$/.test(m)||v?G(e):q(R.y2),re(),!1}function de(e,t){S=(x=e)+R.width,z=(w=t)+R.height,we.extend(R,{x1:B(x),y1:Q(w),x2:B(S),y2:Q(z)}),_(),n.onSelectChange(o,U())}function ae(e){return x=ze(r,ke(u+F(e),r+d-R.width)),w=ze(c,ke(l+G(e),c+a-R.height)),de(x,w),e.preventDefault(),!1}function ue(){we(document).off("mousemove touchmove",ue),Z(),S=x,z=w,re(),m="",E.is(":visible")||N.add(E).hide().fadeIn(n.fadeSpeed||0),b=!0,we(document).off("mouseup touchend",le).on("mousemove touchmove",ce).one("mouseup touchend",ie),N.off("mousemove touchmove",oe),n.onSelectStart(o,U())}function le(){we(document).off("mousemove touchmove",ue).off("mouseup touchend",le),te(N.add(E)),V(B(x),Q(w),B(x),Q(w)),this instanceof we.imgAreaSelect||(n.onSelectChange(o,U()),n.onSelectEnd(o,U()))}function he(e){return 1<e.which||E.is(":animated")||(Z(),u=x=F(e),l=w=G(e),we(document).on({"mousemove touchmove":ue,"mouseup touchend":le})),!1}function fe(){ee(!1)}function me(){t=!0,ge(n=we.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},n)),N.add(E).css({visibility:""}),n.show&&(b=!0,Z(),_(),N.add(E).hide().fadeIn(n.fadeSpeed||0)),setTimeout(function(){n.onInit(o,U())},0)}var pe=function(e){var t,o=n.keys,i=e.keyCode,s=isNaN(o.alt)||!e.altKey&&!e.originalEvent.altKey?!isNaN(o.ctrl)&&e.ctrlKey?o.ctrl:!isNaN(o.shift)&&e.shiftKey?o.shift:isNaN(o.arrows)?10:o.arrows:o.alt;if("resize"==o.arrows||"resize"==o.shift&&e.shiftKey||"resize"==o.ctrl&&e.ctrlKey||"resize"==o.alt&&(e.altKey||e.originalEvent.altKey)){switch(i){case 37:s=-s;case 39:t=ze(x,S),x=ke(x,S),S=ze(t+s,x),ne();break;case 38:s=-s;case 40:t=ze(w,z),w=ke(w,z),z=ze(t+s,w),ne(!0);break;default:return}re()}else switch(x=ke(x,S),w=ke(w,z),i){case 37:de(ze(x-s,r),w);break;case 38:de(x,ze(w-s,c));break;case 39:de(x+ke(s,d-B(S)),w);break;case 40:de(x,w+ke(s,a-Q(z)));break;default:return}return!1};function ye(e,t){for(var o in t)void 0!==n[o]&&e.css(t[o],n[o])}function ge(e){if(e.parent&&(s=we(e.parent)).append(N.add(E)),we.extend(n,e),Z(),null!=e.handles){for(O.remove(),O=we([]),C=e.handles?"corners"==e.handles?4:8:0;C--;)O=O.add(Ae());O.addClass(n.classPrefix+"-handle").css({position:"absolute",fontSize:"0",zIndex:j+1||1}),0<=!parseInt(O.css("width"))&&O.width(5).height(5),(A=n.borderWidth)&&O.css({borderWidth:A,borderStyle:"solid"}),ye(O,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(h=n.imageWidth/d||1,f=n.imageHeight/a||1,null!=e.x1&&(V(e.x1,e.y1,e.x2,e.y2),e.show=!e.hide),e.keys&&(n.keys=we.extend({shift:1,ctrl:"resize"},e.keys)),E.addClass(n.classPrefix+"-outer"),H.addClass(n.classPrefix+"-selection"),C=0;C++<4;)we(M[C-1]).addClass(n.classPrefix+"-border"+C);ye(H,{selectionColor:"background-color",selectionOpacity:"opacity"}),ye(M,{borderOpacity:"opacity",borderWidth:"border-width"}),ye(E,{outerColor:"background-color",outerOpacity:"opacity"}),(A=n.borderColor1)&&we(M[0]).css({borderStyle:"solid",borderColor:A}),(A=n.borderColor2)&&we(M[1]).css({borderStyle:"dashed",borderColor:A}),N.append(H.add(M).add(i)).append(O),ve&&((A=(E.css("filter")||"").match(/opacity=(\d+)/))&&E.css("opacity",A[1]/100),(A=(M.css("filter")||"").match(/opacity=(\d+)/))&&M.css("opacity",A[1]/100)),e.hide?te(N.add(E)):e.show&&t&&(b=!0,N.add(E).fadeIn(n.fadeSpeed||0),ee()),v=(k=(n.aspectRatio||"").split(/:/))[0]/k[1],P.add(E).off("mousedown",he),n.disable||!1===n.enable?(N.off({"mousemove touchmove":oe,"mousedown touchstart":se}),we(window).off("resize",fe)):(!n.enable&&!1!==n.disable||((n.resizable||n.movable)&&N.on({"mousemove touchmove":oe,"mousedown touchstart":se}),we(window).on("resize",fe)),n.persistent||P.add(E).on("mousedown touchstart",he)),n.enable=n.disable=void 0}this.remove=function(){ge({disable:!0}),N.add(E).remove()},this.getOptions=function(){return n},this.setOptions=ge,this.getSelection=U,this.setSelection=V,this.cancelSelection=le,this.update=ee;for(var ve=(/msie ([\w.]+)/i.exec(Y)||[])[1],be=/opera/i.test(Y),Y=/webkit/i.test(Y)&&!/chrome/i.test(Y),xe=P;xe.length;)j=ze(j,isNaN(xe.css("z-index"))?j:xe.css("z-index")),"fixed"==xe.css("position")&&(D="fixed"),xe=xe.parent(":not(body)");j=n.zIndex||j,ve&&P.attr("unselectable","on"),we.imgAreaSelect.keyPress=ve||Y?"keydown":"keypress",be&&(i=Ae().css({width:"100%",height:"100%",position:"absolute",zIndex:j+2||2})),N.add(E).css({visibility:"hidden",position:D,overflow:"hidden",zIndex:j||"0"}),N.css({zIndex:j+2||2}),H.add(M).css({position:"absolute",fontSize:"0"}),o.complete||"complete"==o.readyState||!P.is("img")?me():P.one("load",me),!t&&ve&&7<=ve&&(o.src=o.src)},we.fn.imgAreaSelect=function(e){return e=e||{},this.each(function(){we(this).data("imgAreaSelect")?e.remove?(we(this).data("imgAreaSelect").remove(),we(this).removeData("imgAreaSelect")):we(this).data("imgAreaSelect").setOptions(e):e.remove||(void 0===e.enable&&void 0===e.disable&&(e.enable=!0),we(this).data("imgAreaSelect",new we.imgAreaSelect(this,e)))}),e.instance?we(this).data("imgAreaSelect"):this}}(jQuery);
=======
!function(we){var Se=Math.abs,ze=Math.max,ke=Math.min,Ce=Math.round;function Ae(){return we("<div/>")}we.imgAreaSelect=function(o,n){var T,L,r,c,d,a,t,j,D,R,X,i,Y,$,q,B,s,Q,u,l,h,f,F,m,p,y,g,G,v=we(o),b=Ae(),x=Ae(),w=Ae().add(Ae()).add(Ae()).add(Ae()),S=Ae().add(Ae()).add(Ae()).add(Ae()),z=we([]),k={left:0,top:0},C={left:0,top:0},A=0,J="absolute",W={x1:0,y1:0,x2:0,y2:0,width:0,height:0},U=document.documentElement,V=navigator.userAgent;function I(e){return e+k.left-C.left}function K(e){return e+k.top-C.top}function P(e){return e-k.left+C.left}function N(e){return e-k.top+C.top}function Z(e){return ze(e.pageX||0,ee(e).x)-C.left}function _(e){return ze(e.pageY||0,ee(e).y)-C.top}function ee(e){e=e.originalEvent||{};return e.touches&&e.touches.length?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:0,y:0}}function H(e){var t=e||R,e=e||X;return{x1:Ce(W.x1*t),y1:Ce(W.y1*e),x2:Ce(W.x2*t),y2:Ce(W.y2*e),width:Ce(W.x2*t)-Ce(W.x1*t),height:Ce(W.y2*e)-Ce(W.y1*e)}}function te(e,t,o,i,s){var n=s||R,s=s||X;(W={x1:Ce(e/n||0),y1:Ce(t/s||0),x2:Ce(o/n||0),y2:Ce(i/s||0)}).width=W.x2-W.x1,W.height=W.y2-W.y1}function M(){T&&v.width()&&(k={left:Ce(v.offset().left),top:Ce(v.offset().top)},d=v.innerWidth(),a=v.innerHeight(),k.top+=v.outerHeight()-a>>1,k.left+=v.outerWidth()-d>>1,Y=Ce(n.minWidth/R)||0,$=Ce(n.minHeight/X)||0,q=Ce(ke(n.maxWidth/R||1<<24,d)),B=Ce(ke(n.maxHeight/X||1<<24,a)),"1.3.2"!=we().jquery||"fixed"!=J||U.getBoundingClientRect||(k.top+=ze(document.body.scrollTop,U.scrollTop),k.left+=ze(document.body.scrollLeft,U.scrollLeft)),C=/absolute|relative/.test(t.css("position"))?{left:Ce(t.offset().left)-t.scrollLeft(),top:Ce(t.offset().top)-t.scrollTop()}:"fixed"==J?{left:we(document).scrollLeft(),top:we(document).scrollTop()}:{left:0,top:0},r=I(0),c=K(0),(W.x2>d||W.y2>a)&&de())}function oe(e){if(Q){switch(b.css({left:I(W.x1),top:K(W.y1)}).add(x).width(y=W.width).height(g=W.height),x.add(w).add(z).css({left:0,top:0}),w.width(ze(y-w.outerWidth()+w.innerWidth(),0)).height(ze(g-w.outerHeight()+w.innerHeight(),0)),we(S[0]).css({left:r,top:c,width:W.x1,height:a}),we(S[1]).css({left:r+W.x1,top:c,width:y,height:W.y1}),we(S[2]).css({left:r+W.x2,top:c,width:d-W.x2,height:a}),we(S[3]).css({left:r+W.x1,top:c+W.y2,width:y,height:a-W.y2}),y-=z.outerWidth(),g-=z.outerHeight(),z.length){case 8:we(z[4]).css({left:y>>1}),we(z[5]).css({left:y,top:g>>1}),we(z[6]).css({left:y>>1,top:g}),we(z[7]).css({top:g>>1});case 4:z.slice(1,3).css({left:y}),z.slice(2,4).css({top:g})}!1!==e&&(we.imgAreaSelect.onKeyPress!=ge&&we(document).off(we.imgAreaSelect.keyPress,we.imgAreaSelect.onKeyPress),n.keys&&we(document).on(we.imgAreaSelect.keyPress,function(){we.imgAreaSelect.onKeyPress=ge})),O&&w.outerWidth()-w.innerWidth()==2&&(w.css("margin",0),setTimeout(function(){w.css("margin","auto")},0))}}function ie(e){M(),oe(e),u=I(W.x1),l=K(W.y1),h=I(W.x2),f=K(W.y2)}function se(e,t){n.fadeSpeed?e.fadeOut(n.fadeSpeed,t):e.hide()}function E(e){var t=P(Z(e))-W.x1,e=N(_(e))-W.y1;G||(M(),G=!0,b.one("mouseout",function(){G=!1})),i="",n.resizable&&(e<=n.resizeMargin?i="n":e>=W.height-n.resizeMargin&&(i="s"),t<=n.resizeMargin?i+="w":t>=W.width-n.resizeMargin&&(i+="e")),b.css("cursor",i?i+"-resize":n.movable?"move":""),L&&L.toggle()}function ne(e){we("body").css("cursor",""),!n.autoHide&&W.width*W.height!=0||se(b.add(S),function(){we(this).hide()}),we(document).off("mousemove touchmove",ae),b.on("mousemove touchmove",E),n.onSelectEnd(o,H())}function re(e){return"mousedown"==e.type&&1!=e.which||(E(e),M(),i?(we("body").css("cursor",i+"-resize"),u=I(W[/w/.test(i)?"x2":"x1"]),l=K(W[/n/.test(i)?"y2":"y1"]),we(document).on("mousemove touchmove",ae).one("mouseup touchend",ne),b.off("mousemove touchmove",E)):n.movable?(j=r+W.x1-Z(e),D=c+W.y1-_(e),b.off("mousemove touchmove",E),we(document).on("mousemove touchmove",le).one("mouseup touchend",function(){n.onSelectEnd(o,H()),we(document).off("mousemove touchmove",le),b.on("mousemove touchmove",E)})):v.mousedown(e)),!1}function ce(e){s&&(e?(h=ze(r,ke(r+d,u+Se(f-l)*s*(u<h||-1))),f=Ce(ze(c,ke(c+a,l+Se(h-u)/s*(l<f||-1)))),h=Ce(h)):(f=ze(c,ke(c+a,l+Se(h-u)/s*(l<f||-1))),h=Ce(ze(r,ke(r+d,u+Se(f-l)*s*(u<h||-1)))),f=Ce(f)))}function de(){u=ke(u,r+d),l=ke(l,c+a),Se(h-u)<Y&&((h=u-Y*(h<u||-1))<r?u=r+Y:r+d<h&&(u=r+d-Y)),Se(f-l)<$&&((f=l-$*(f<l||-1))<c?l=c+$:c+a<f&&(l=c+a-$)),h=ze(r,ke(h,r+d)),f=ze(c,ke(f,c+a)),ce(Se(h-u)<Se(f-l)*s),Se(h-u)>q&&(h=u-q*(h<u||-1),ce()),Se(f-l)>B&&(f=l-B*(f<l||-1),ce(!0)),W={x1:P(ke(u,h)),x2:P(ze(u,h)),y1:N(ke(l,f)),y2:N(ze(l,f)),width:Se(h-u),height:Se(f-l)},oe(),n.onSelectChange(o,H())}function ae(e){return h=/w|e|^$/.test(i)||s?Z(e):I(W.x2),f=/n|s|^$/.test(i)||s?_(e):K(W.y2),de(),!1}function ue(e,t){h=(u=e)+W.width,f=(l=t)+W.height,we.extend(W,{x1:P(u),y1:N(l),x2:P(h),y2:N(f)}),oe(),n.onSelectChange(o,H())}function le(e){return u=ze(r,ke(j+Z(e),r+d-W.width)),l=ze(c,ke(D+_(e),c+a-W.height)),ue(u,l),e.preventDefault(),!1}function he(){we(document).off("mousemove touchmove",he),M(),h=u,f=l,de(),i="",S.is(":visible")||b.add(S).hide().fadeIn(n.fadeSpeed||0),Q=!0,we(document).off("mouseup touchend",fe).on("mousemove touchmove",ae).one("mouseup touchend",ne),b.off("mousemove touchmove",E),n.onSelectStart(o,H())}function fe(){we(document).off("mousemove touchmove",he).off("mouseup touchend",fe),se(b.add(S)),te(P(u),N(l),P(u),N(l)),this instanceof we.imgAreaSelect||(n.onSelectChange(o,H()),n.onSelectEnd(o,H()))}function me(e){return 1<e.which||S.is(":animated")||(M(),j=u=Z(e),D=l=_(e),we(document).on({"mousemove touchmove":he,"mouseup touchend":fe})),!1}function pe(){ie(!1)}function ye(){T=!0,be(n=we.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},n)),b.add(S).css({visibility:""}),n.show&&(Q=!0,M(),oe(),b.add(S).hide().fadeIn(n.fadeSpeed||0)),setTimeout(function(){n.onInit(o,H())},0)}var ge=function(e){var t,o=n.keys,i=e.keyCode,s=isNaN(o.alt)||!e.altKey&&!e.originalEvent.altKey?!isNaN(o.ctrl)&&e.ctrlKey?o.ctrl:!isNaN(o.shift)&&e.shiftKey?o.shift:isNaN(o.arrows)?10:o.arrows:o.alt;if("resize"==o.arrows||"resize"==o.shift&&e.shiftKey||"resize"==o.ctrl&&e.ctrlKey||"resize"==o.alt&&(e.altKey||e.originalEvent.altKey)){switch(i){case 37:s=-s;case 39:t=ze(u,h),u=ke(u,h),h=ze(t+s,u),ce();break;case 38:s=-s;case 40:t=ze(l,f),l=ke(l,f),f=ze(t+s,l),ce(!0);break;default:return}de()}else switch(u=ke(u,h),l=ke(l,f),i){case 37:ue(ze(u-s,r),l);break;case 38:ue(u,ze(l-s,c));break;case 39:ue(u+ke(s,d-P(h)),l);break;case 40:ue(u,l+ke(s,a-N(f)));break;default:return}return!1};function ve(e,t){for(var o in t)void 0!==n[o]&&e.css(t[o],n[o])}function be(e){if(e.parent&&(t=we(e.parent)).append(b.add(S)),we.extend(n,e),M(),null!=e.handles){for(z.remove(),z=we([]),m=e.handles?"corners"==e.handles?4:8:0;m--;)z=z.add(Ae());z.addClass(n.classPrefix+"-handle").css({position:"absolute",fontSize:"0",zIndex:A+1||1}),0<=!parseInt(z.css("width"))&&z.width(5).height(5),(p=n.borderWidth)&&z.css({borderWidth:p,borderStyle:"solid"}),ve(z,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(R=n.imageWidth/d||1,X=n.imageHeight/a||1,null!=e.x1&&(te(e.x1,e.y1,e.x2,e.y2),e.show=!e.hide),e.keys&&(n.keys=we.extend({shift:1,ctrl:"resize"},e.keys)),S.addClass(n.classPrefix+"-outer"),x.addClass(n.classPrefix+"-selection"),m=0;m++<4;)we(w[m-1]).addClass(n.classPrefix+"-border"+m);ve(x,{selectionColor:"background-color",selectionOpacity:"opacity"}),ve(w,{borderOpacity:"opacity",borderWidth:"border-width"}),ve(S,{outerColor:"background-color",outerOpacity:"opacity"}),(p=n.borderColor1)&&we(w[0]).css({borderStyle:"solid",borderColor:p}),(p=n.borderColor2)&&we(w[1]).css({borderStyle:"dashed",borderColor:p}),b.append(x.add(w).add(L)).append(z),O&&((p=(S.css("filter")||"").match(/opacity=(\d+)/))&&S.css("opacity",p[1]/100),(p=(w.css("filter")||"").match(/opacity=(\d+)/))&&w.css("opacity",p[1]/100)),e.hide?se(b.add(S)):e.show&&T&&(Q=!0,b.add(S).fadeIn(n.fadeSpeed||0),ie()),s=(F=(n.aspectRatio||"").split(/:/))[0]/F[1],v.add(S).off("mousedown",me),n.disable||!1===n.enable?(b.off({"mousemove touchmove":E,"mousedown touchstart":re}),we(window).off("resize",pe)):(!n.enable&&!1!==n.disable||((n.resizable||n.movable)&&b.on({"mousemove touchmove":E,"mousedown touchstart":re}),we(window).on("resize",pe)),n.persistent||v.add(S).on("mousedown touchstart",me)),n.enable=n.disable=void 0}this.remove=function(){be({disable:!0}),b.add(S).remove()},this.getOptions=function(){return n},this.setOptions=be,this.getSelection=H,this.setSelection=te,this.cancelSelection=fe,this.update=ie;for(var O=(/msie ([\w.]+)/i.exec(V)||[])[1],xe=/opera/i.test(V),V=/webkit/i.test(V)&&!/chrome/i.test(V),e=v;e.length;)A=ze(A,isNaN(e.css("z-index"))?A:e.css("z-index")),"fixed"==e.css("position")&&(J="fixed"),e=e.parent(":not(body)");A=n.zIndex||A,O&&v.attr("unselectable","on"),we.imgAreaSelect.keyPress=O||V?"keydown":"keypress",xe&&(L=Ae().css({width:"100%",height:"100%",position:"absolute",zIndex:A+2||2})),b.add(S).css({visibility:"hidden",position:J,overflow:"hidden",zIndex:A||"0"}),b.css({zIndex:A+2||2}),x.add(w).css({position:"absolute",fontSize:"0"}),o.complete||"complete"==o.readyState||!v.is("img")?ye():v.one("load",ye),!T&&O&&7<=O&&(o.src=o.src)},we.fn.imgAreaSelect=function(e){return e=e||{},this.each(function(){we(this).data("imgAreaSelect")?e.remove?(we(this).data("imgAreaSelect").remove(),we(this).removeData("imgAreaSelect")):we(this).data("imgAreaSelect").setOptions(e):e.remove||(void 0===e.enable&&void 0===e.disable&&(e.enable=!0),we(this).data("imgAreaSelect",new we.imgAreaSelect(this,e)))}),e.instance?we(this).data("imgAreaSelect"):this}}(jQuery);
>>>>>>> main
